---
title: "SIR Epidemic Model"
subtitle: "1D Ordinary Differential Equations"
format: html
---

The SIR model is a classical compartmental model in epidemiology. It splits the population into:

- $S(t)$: susceptible
- $I(t)$: infected
- $R(t)$: recovered

and describes how individuals move between these compartments over time.

We will use the normalized SIR model (fractions of the population, so $S+I+R=1$):

$$
\begin{aligned}
\dot S &= -\beta SI,\\
\dot I &= \beta SI - \gamma I,\\
\dot R &= \gamma I.
\end{aligned}
$$ {#eq-ode-1d-sir-1}

- $\beta$ controls infection/transmission.
- $\gamma$ controls recovery.

## Reference Implementation {#sec-reference}

A working implementation is provided in:

- `amlab/odes_1d/sir_model.py`

The model function is `sir_model(t, y, beta, gamma)` and the plotting helper is `plot_sir_model(...)`.

## Render-time Figure {#sec-render-figure}

The figure below is generated at render-time from the reference script.

```{python}
#| label: fig-sir
#| fig-cap: "SIR dynamics for default parameters."
#| fig-width: 8
#| fig-height: 4
#| echo: false
import matplotlib.pyplot as plt

from amlab.odes_1d.sir_model import plot_sir_model

plot_sir_model(beta=0.3, gamma=0.1, s0=0.99, i0=0.01, r0=0.0, t_show=160)
plt.show()
plt.close()
```

## Exploration {#sec-exploration}

1. Increase $\beta$ while keeping $\gamma$ fixed. What happens to the peak of $I(t)$?
2. Increase $\gamma$ while keeping $\beta$ fixed. Does the epidemic end sooner?
3. Try different initial infected fractions $I(0)$. Do you always see an outbreak?

## Run Locally {#sec-run-locally}

To run the standalone script and show the plot:

```bash
python amlab/odes_1d/sir_model.py
```
