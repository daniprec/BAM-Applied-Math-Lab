---
title: "Lorenz Attractor"
subtitle: "3D Chaotic Dynamics"
format: html
---

The Lorenz system is a classic example of deterministic chaos:

$$
\begin{aligned}
\dot x &= s (y - x), \\
\dot y &= r x - y - x z, \\
\dot z &= x y - b z.
\end{aligned}
$$ {#eq-lorenz-lorenz-1}

```{python}
#| label: fig-lorenz
#| fig-cap: 'Lorenz attractor trajectory (Euler integration).'
#| fig-width: 6
#| fig-height: 5
#| echo: false

import numpy as np
import matplotlib.pyplot as plt

from amlab.extra.lorenz_attractor import lorenz

num_steps = 5000
dt = 0.01
xyzs = np.empty((num_steps + 1, 3))
xyzs[0] = (0.0, 1.0, 1.05)

for i in range(num_steps):
    xyzs[i + 1] = xyzs[i] + lorenz(xyzs[i]) * dt

ax = plt.figure().add_subplot(projection="3d")
ax.plot(*xyzs.T, lw=0.6)
ax.set_xlabel("X")
ax.set_ylabel("Y")
ax.set_zlabel("Z")
ax.set_title("Lorenz Attractor")
plt.show()
plt.close()
```

## Implement the vector field

```python
def lorenz(xyz, s=10, r=28, b=2.667):
    x, y, z = xyz
    x_dot = s * (y - x)
    y_dot = r * x - y - x * z
    z_dot = x * y - b * z
    return np.array([x_dot, y_dot, z_dot])
```

## Simulate with Euler

```python
num_steps = 10000
dt = 0.01
xyzs = np.empty((num_steps + 1, 3))
xyzs[0] = (0.0, 1.0, 1.05)

for i in range(num_steps):
    xyzs[i + 1] = xyzs[i] + lorenz(xyzs[i]) * dt
```

Try changing $r$ or the initial condition and observe how the trajectory changes.

Reference code: [amlab/extra/lorenz_attractor.py](../../amlab/extra/lorenz_attractor.py).
