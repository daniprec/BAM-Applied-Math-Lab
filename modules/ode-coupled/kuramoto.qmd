---
title: "Kuramoto Model"
subtitle: "Theory"
format: html
---

The Kuramoto model describes a population of weakly coupled oscillators. Each oscillator has a phase $\theta_i$ and a natural frequency $\omega_i$.

The **natural frequency** of each oscillator ($\omega_i$) is drawn from a normal distribution centered at zero, and with standard deviation (scale parameter) $\sigma$. The density function of this normal distribution is:

$$
g(\omega) = \frac{1}{\sqrt{2\pi}\sigma} \exp\left(-\frac{\omega^2}{2\sigma^2}\right).
$$

The **initial phase** of each oscillator ($\theta_i$) is drawn from an uniform distribution between $0$ and $2\pi$.

For any system of weakly coupled, nearly identical **limit-cycle oscillators**, the long-term dynamics are given by phase equations of the following universal form:

$$
\dot\theta_i = \omega_i + \sum_{j=1}^N \Gamma_{ij} \left( \theta_j - \theta_i \right),\quad i = 1, \dots, N
$$

The Kuramoto model corresponds to the simplest possible case of equally weighted, all-to-all, purely sinusoidal coupling:

$$
\Gamma_{ij}(\theta) = \frac{K}{N} \sin \left( \theta_j - \theta_i \right)$$

## The Order Parameter

To visualize the dynamics of the phases, it is convenient to imagine a swarm of points running around the unit circle in the complex plane.

The complex **order parameter** is a macroscopic quantity that can be interpreted as the collective rhythm produced by the whole population.

$$
r e^{i\Psi} = \frac{1}{N} \sum_{j=1}^N e^{i\theta_j}
$$

@fig-kuramoto-circle shows a snapshot of the oscillators (blue dots) and the order parameter (red arrow) pointing towards the centroid of the phases. If you want to see this in action, run the script in [amlab/odes_coupled/kuramoto.py](../../amlab/odes_coupled/kuramoto.py) to animate the oscillators on the unit circle.

```{python}
#| label: fig-kuramoto-circle
#| fig-cap: 'Oscillators (blue dots) on the unit circle. The order parameter (red) points towards the centroid of the phases.'
#| fig-width: 6
#| fig-height: 6
#| echo: false

import numpy as np
import matplotlib.pyplot as plt

from amlab.odes_coupled.kuramoto import initialize_oscillators, kuramoto_order_parameter

num_oscillators = 100
theta, omega = initialize_oscillators(
    num_oscillators,
    distribution="normal",
    scale_omega=0.5,
    scale_phase=0.6,
    seed=1)

x = np.cos(theta)
y = np.sin(theta)

r, phi, rcosphi, rsinphi = kuramoto_order_parameter(theta)

fig, ax = plt.subplots(figsize=(6, 6))
ax.set_title("Kuramoto Model")
ax.set_xlabel("Cos(theta)")
ax.set_ylabel("Sin(theta)")
ax.set_xlim(-1.1, 1.1)
ax.set_ylim(-1.1, 1.1)
ax.set_aspect("equal")
ax.grid(True)

circle = plt.Circle((0, 0), 1, color="lightgray", fill=False)
ax.add_artist(circle)
ax.scatter(x, y, s=50, color="blue", alpha=0.5)
ax.plot([0, rcosphi], [0, rsinphi], color="red", linewidth=2)
ax.plot([rcosphi], [rsinphi], "ro", markersize=6)
plt.show()
plt.close()
```

## Mean Field Approximation

Kuramoto noticed that the governing equation can be rewritten neatly in terms of the order parameter:

$$
\dot\theta_i = \omega_i + K r \sin(\Psi - \theta_i),\quad i = 1, \dots, N $$

## A Positive Feedback Loop

1. The phase $\theta_i$ is pulled toward the mean phase $\Psi$.
2. The population becomes more coherent. In turn, the order parameter $r$ increases.
3. The effective strength of the coupling $K r$ increases proportionally to the coherence.
4. $K r$ tends to recruit even more oscillators into the synchronized cluster, which feeds step 1.

## Spontaneous Synchronization

Positive feedback loop between coupling ($K$) and coherence ($r$).

If the coherence is further increased by the new recruits, the process will continue; otherwise, it becomes self-limiting.

## Goal of this Session

Implement the Kuramoto model in Python, visualize the oscillators on a unit circle and find when the spontaneous synchronization happens.

Play with the following parameters and see how they affect the dynamics:

- Coupling strength, $K > 0$
- Number of oscillators, $N$

You can follow two approaches to the ODE function.

### Pairwise Interactions

$$
\dot\theta_i = \omega_i + \sum_{j=1}^N \Gamma_{ij} \left( \theta_j - \theta_i \right),\quad i = 1, \dots, N
$$

$$
\Gamma_{ij}(\theta) = \frac{K}{N} \sin \left( \theta_j - \theta_i \right)$$

### Mean Field Approximation

$$
\dot\theta_i = \omega_i + K r \sin(\Psi - \theta_i),\quad i = 1, \dots, N $$

$$
r e^{i\Psi} = \frac{1}{N} \sum_{j=1}^N e^{i\theta_j}
$$

---

We will start by initializing the oscillators and plotting them on the unit circle. Then, we will define the ODE function and use `scipy.integrate.solve_ivp()` to simulate the dynamics. Follow to the next page for the implementation details.

[Oscillators and Animation](kuramoto-oscillators.qmd){.btn .btn-primary}

## Reference

[From Kuramoto to Crawford: exploring the onset of synchronization in populations of coupled oscillators](https://doi.org/10.1016/S0167-2789(00)00094-4) by Steven H. Strogatz.
