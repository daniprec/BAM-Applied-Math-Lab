---
title: "Van der Pol Oscillator"
subtitle: "2D Ordinary Differential Equations"
format: html
---

The Van der Pol oscillator is a prototypical nonlinear system that exhibits **self-sustained oscillations**.
For a wide range of initial conditions, trajectories converge to a stable **limit cycle**.

In the form we will use in this course, the system is written as [@strogatz2024nonlinear, chap. 7.5]:

$$\begin{aligned}
\dot x &= \mu\,(y - f(x)) \\
\dot y &= -\frac{x}{\mu}
\end{aligned}$$

where $\mu>0$ controls the strength of the nonlinearity (and the fastâ€“slow character for large $\mu$), and

$$
f(x) = \frac{x^3}{3} - x.
$$

```{python}
#| label: fig-phase-plane
#| fig-cap: "Phase plane of the Van der Pol system with mu = 3. Trajectories are shown for different initial conditions (IC as x-y, marked black). Generated with `scipy.integrate.solve_ivp()` and matplotlib."
#| fig-width: 8
#| fig-height: 4
#| echo: false

import matplotlib.pyplot as plt
import numpy as np
from scipy.integrate import solve_ivp

from sessions.s02_odes_2d.van_der_pol import van_der_pol

ls_xy = [(-2, 2), (2, -2), (-0.1, 0.1)]
mu = 3

fig, ax = plt.subplots(figsize=(8, 4))
for x0, y0 in ls_xy:
	sol = solve_ivp(
		van_der_pol,
		[0, 40],
		[x0, y0],
		args=(mu,),
		t_eval=np.linspace(0, 40, 4000),
	)
	ax.plot(sol.y[0], sol.y[1], label=f"IC: ({x0}, {y0})")
	# Mark the initial condition
	ax.plot(x0, y0, "o", color="black")

plt.xlabel("x")
plt.ylabel("y")
plt.legend()
plt.show()
plt.close()
```

Follow the steps outline in [the CDIMA model](cdima.qmd) to explore how the Van der Pol system behaves for different initial conditions and parameters.

## The Stable Limit Cycle

The Van der Pol system has a stable limit cycle that attracts trajectories from a wide range of initial conditions.
Plot this limit cycle as a $x(t)-t$ plot, and verify that it matches the phase plane trajectories.

```{python}
#| label: fig-limit-cycle
#| fig-cap: "Time series of x(t) for the Van der Pol system with mu = 3 and IC: (2, -2). Generated with `scipy.integrate.solve_ivp()` and matplotlib."
#| fig-width: 8
#| fig-height: 4
#| echo: false
xy = (2, -2)

fig, ax = plt.subplots(figsize=(8, 4))
sol = solve_ivp(
    van_der_pol,
    [0, 40],
    xy,
    args=(mu,),
    t_eval=np.linspace(0, 40, 4000),
)
ax.plot(sol.t, sol.y[0])
plt.xlabel("Time (t)")
plt.ylabel("x(t)")
plt.legend()
plt.show()
plt.close()
```

The amplitude and period of the limit cycle depend on $\mu$. There are two phases of the limit cycle: a slow phase where trajectories move slowly near the cubic nullcline, and a fast phase where trajectories rapidly jump between branches of the nullcline. The speed of the slow phase increases with $\mu$, while the fast phase becomes more abrupt. This leads to a characteristic "relaxation oscillation" shape for large $\mu$.

Play with the parameter $\mu$ to see how it changes the shape of the limit cycle and the transient dynamics.

## Resources

- [@strogatz2024nonlinear, chap. 7.5] for theoretical background on the Van der Pol oscillator.
- SciPy documentation: <https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html>
- Reference implementation: <https://github.com/daniprec/BAM-Applied-Math-Lab/tree/main/sessions/s02_odes_2d>