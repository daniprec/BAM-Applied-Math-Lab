---
title: "Van der Pol Oscillator (Phase Plane + Nullclines)"
subtitle: "2D Ordinary Differential Equations"
format: html
---

## Introduction {#sec-introduction}

The Van der Pol oscillator is a canonical nonlinear system that exhibits a **limit cycle** and, for large $\mu$, a **relaxation oscillation**.

The reference implementation is in:

- `sessions/s02_odes_2d/van_der_pol.py`

## Model {#sec-model}

Using the same form as the reference script:

$$
\begin{aligned}
\dot x &= \mu\left(y - \left(\frac{x^3}{3} - x\right)\right),\\
\dot y &= -\frac{x}{\mu}.
\end{aligned}
$$

## Render-time Phase Plane {#sec-render-phase-plane}

```{python}
#| label: fig-vdp-phase
#| fig-cap: "Van der Pol: trajectory in the phase plane with numerically approximated nullclines."
#| fig-width: 8
#| fig-height: 5
#| echo: false

import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp
from scipy.optimize import fsolve

from sessions.s02_odes_2d.van_der_pol import van_der_pol
from sessions.s02_odes_2d.cdima import compute_nullclines

mu = 2.0
args = (mu,)

t_span = (0.0, 60.0)
t_eval = np.linspace(t_span[0], t_span[1], 6000)
y0 = np.array([0.1, 0.0])

sol = solve_ivp(van_der_pol, t_span, y0, t_eval=t_eval, args=args, method="RK45")
x, y = sol.y

limits = (-4.0, -4.0, 4.0, 4.0)
(x_nc, y_nc) = compute_nullclines(van_der_pol, args=list(args), t=t_span[0], limits=limits, num_points=220)

fp = fsolve(lambda z: van_der_pol(None, z, *args), y0)

fig, ax = plt.subplots(figsize=(8, 5))
ax.plot(x, y, lw=1.5, color="black", label="trajectory")
ax.plot(x_nc[0], x_nc[1], linestyle="None", marker="o", markersize=0.8, color="blue", label="$\\dot x=0$")
ax.plot(y_nc[0], y_nc[1], linestyle="None", marker="o", markersize=0.8, color="red", label="$\\dot y=0$")
ax.plot([fp[0]], [fp[1]], "ko", label="fixed point")
ax.set_xlabel("x")
ax.set_ylabel("y")
ax.set_xlim(limits[0], limits[2])
ax.set_ylim(limits[1], limits[3])
ax.set_title(f"Van der Pol phase plane (mu={mu})")
ax.grid(True)
ax.legend(loc="best")
plt.show()
plt.close()
```

## Run the Interactive Version {#sec-run-interactive}

```bash
python sessions/s02_odes_2d/van_der_pol.py
```
