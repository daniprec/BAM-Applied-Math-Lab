---
title: "CDIMA Reaction"
subtitle: "2D Ordinary Differential Equations"
format: html
---

The CDIMA model (Chlorine Dioxide–Iodine–Malonic Acid reaction) is a classic 2D chemical oscillator used to study phase-plane dynamics.
The equations are:

$$\begin{aligned}
\dot x &= a - x \frac{4xy}{1+x^2} \\
\dot y &= bx \left( 1 - \frac{y}{1+x^2} \right)
\end{aligned}$$

where $x$ and $y$ represent concentrations of chemical species, and $a,b$ are parameters controlling the reaction rates.

## Phase-Plane Analysis

To understand the dynamics, we can analyze the phase plane. 
A **phase plane** is a 2D plot whose axes are the state variables (here, $x$ and $y$). Each point $(x,y)$ represents the system's state at a given time, and the differential equations define a **vector field** on this plane that indicates how the state evolves. Trajectories (solution curves) show how $(x(t),y(t))$ moves through the plane, revealing features such as equilibrium points, nullclines, limit cycles, and their stability.

```{python}
#| label: fig-phase-plane
#| fig-cap: "Phase plane of the CDIMA system with a = 10, b = 4. Trajectories are shown for different initial conditions (IC as x, y). Generated with `scipy.integrate.solve_ivp()` and matplotlib."
#| fig-width: 8
#| fig-height: 4
#| echo: false

import matplotlib.pyplot as plt
import numpy as np
from scipy.integrate import solve_ivp

from sessions.s02_odes_2d.cdima import cdima

ls_xy = [(0, 3), (0, 1.5), (2, 0)]
a, b = 10, 4

fig, ax = plt.subplots(figsize=(8, 4))
for x0, y0 in ls_xy:
    sol = solve_ivp(cdima, [0, 20], [x0, y0], args=(a, b), t_eval=np.linspace(0, 20, 2000))
    ax.plot(sol.y[0], sol.y[1], label=f"IC: ({x0}, {y0})")
plt.xlabel("x")
plt.ylabel("y")
plt.legend()
plt.show()
plt.close()
```