---
title: "2D Ordinary Differential Equations"
subtitle: "CDIMA Reaction (Phase Plane + Nullclines)"
author: "Daniel Precioso Garcelán"
bibliography: ../../tex/references.bib
format: html
---

## Introduction {#sec-introduction}

The CDIMA model (Chlorine Dioxide–Iodine–Malonic Acid reaction) is a classic 2D chemical oscillator used to study phase-plane dynamics.

This page focuses on:

- integrating a 2D system with `solve_ivp`
- plotting trajectories in the phase plane
- computing numerical nullclines using the shared helper `compute_nullclines`

## Model {#sec-model}

The reference implementation lives in:

- `sessions/s02_odes_2d/cdima.py`

and defines the vector field:

$$
\begin{aligned}
\dot x &= a - x - \frac{4xy}{1+x^2},\\
\dot y &= bx\left(1 - \frac{y}{1+x^2}\right).
\end{aligned}
$$

## Render-time Phase Plane {#sec-render-phase-plane}

```{python}
#| label: fig-cdima-phase
#| fig-cap: "CDIMA: trajectory in the phase plane with numerically approximated nullclines."
#| fig-width: 8
#| fig-height: 5
#| echo: false

import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp
from scipy.optimize import fsolve

from sessions.s02_odes_2d.cdima import cdima, compute_nullclines

# Parameters
args = (10.0, 6.0)  # (a, b)

# Integrate one trajectory
t_span = (0.0, 40.0)
t_eval = np.linspace(t_span[0], t_span[1], 4000)
y0 = np.array([0.5, 0.5])

sol = solve_ivp(cdima, t_span, y0, t_eval=t_eval, args=args, method="RK45")
x, y = sol.y

# Nullclines (use fewer points to keep render time reasonable)
limits = (0.1, 0.0, 5.0, 10.0)
(x_nc, y_nc) = compute_nullclines(cdima, args=list(args), t=t_span[0], limits=limits, num_points=250)

# Fixed point near the initial condition
fp = fsolve(lambda z: cdima(None, z, *args), y0)

fig, ax = plt.subplots(figsize=(8, 5))
ax.plot(x, y, lw=1.5, color="black", label="trajectory")
ax.plot(x_nc[0], x_nc[1], linestyle="None", marker="o", markersize=0.8, color="blue", label="$\\dot x=0$")
ax.plot(y_nc[0], y_nc[1], linestyle="None", marker="o", markersize=0.8, color="red", label="$\\dot y=0$")
ax.plot([fp[0]], [fp[1]], "ko", label="fixed point")
ax.set_xlabel("x")
ax.set_ylabel("y")
ax.set_xlim(limits[0], limits[2])
ax.set_ylim(limits[1], limits[3])
ax.set_title("CDIMA phase plane")
ax.grid(True)
ax.legend(loc="best")
plt.show()
plt.close()
```

## Run the Interactive Version {#sec-run-interactive}

The full interactive + animated version (with click-to-restart) is in the reference script:

```bash
python sessions/s02_odes_2d/cdima.py
```
