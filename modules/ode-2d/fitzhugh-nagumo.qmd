---
title: "FitzHugh–Nagumo Model"
subtitle: "2D Ordinary Differential Equations"
format: html
---

The FitzHugh–Nagumo model is a simplified neuron model that captures key features of excitability and spiking behavior.
It consists of two coupled ODEs:

$$\begin{aligned}
\epsilon \dot v &= f(v) - w + I_{\text{app}} \\
\dot w &= v - \gamma w
\end{aligned}$$

Where $v$ is the fast variable representing the membrane potential, $w$ is a recovery variable, $I_{\text{app}}$ is an applied current, and $\epsilon \ll 1$ controls the timescale separation between the fast variable $v$ and the slow variable $w$. $f(v)$ is a cubic nonlinearity, often taken as

$$
f(v) = v (1 - v)(v - \alpha),\quad \text{for } 0 < \alpha < 1
$$

```{python}
#| label: fig-phase-plane
#| fig-cap: "Phase plane of the FitzHugh–Nagumo system with epsilon = 0.01, gamma = 0.5, and I_app = 0.5. Trajectories are shown for different initial conditions (IC as v-w, marked black). Generated with `scipy.integrate.solve_ivp()` and matplotlib."
#| fig-width: 8
#| fig-height: 4
#| echo: false

import matplotlib.pyplot as plt
import numpy as np
from scipy.integrate import solve_ivp

from sessions.s02_odes_2d.fitzhugh_nagumo import fitzhugh_nagumo

ls_vw = [(0, 0), (0.4, 0), (-0.2, 0)]
epsilon, gamma = 0.01, 0.5
i_app = 0.5

fig, ax = plt.subplots(figsize=(8, 4))
for v0, w0 in ls_vw:
    sol = solve_ivp(fitzhugh_nagumo, [0, 20], [v0, w0], args=(epsilon, gamma, i_app), t_eval=np.linspace(0, 20, 2000))
    ax.plot(sol.y[0], sol.y[1], label=f"IC: ({v0}, {w0})")
    # Mark the initial condition
    ax.plot(v0, w0, 'o', color='black')
plt.xlabel("v")
plt.ylabel("w")
plt.legend()
plt.show()
plt.close()
```

Follow the steps outline in [the CDIMA model](cdima.qmd) to explore how the FitzHugh–Nagumo system behaves for different initial conditions and parameters.