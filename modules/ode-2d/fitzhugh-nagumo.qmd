---
title: "FitzHugh–Nagumo Model"
subtitle: "2D Ordinary Differential Equations"
format: html
---

The FitzHugh–Nagumo model is a simplified neuron model that captures key features of excitability and spiking behavior.
It consists of two coupled ODEs:

$$\begin{aligned}
\epsilon \dot v &= f(v) - w + I_{\text{app}} \\
\dot w &= v - \gamma w
\end{aligned}$$

Where $v$ is the fast variable representing the membrane potential, $w$ is a recovery variable, $I_{\text{app}}$ is an applied current, and $\epsilon \ll 1$ controls the timescale separation between the fast variable $v$ and the slow variable $w$. $f(v)$ is a cubic nonlinearity, often taken as

$$
f(v) = v (1 - v)(v - \alpha),\quad \text{for } 0 < \alpha < 1
$$

```{python}
#| label: fig-phase-plane
#| fig-cap: "Phase plane of the FitzHugh–Nagumo system with epsilon = 0.01, gamma = 0.5, I_app = 0.5 and alpha = 0.1. Trajectories are shown for different initial conditions (IC as v-w, marked black). Generated with `scipy.integrate.solve_ivp()` and matplotlib."
#| fig-width: 8
#| fig-height: 4
#| echo: false

import matplotlib.pyplot as plt
import numpy as np
from scipy.integrate import solve_ivp

from sessions.s02_odes_2d.fitzhugh_nagumo import fitzhugh_nagumo

ls_vw = [(0, 0), (0.4, 0.2), (-0.2, -0.05)]
i_app = 0.5
gamma = 0.5
alpha = 0.1
epsilon = 0.01

fig, ax = plt.subplots(figsize=(8, 4))
for v0, w0 in ls_vw:
    sol = solve_ivp(fitzhugh_nagumo, [0, 20], [v0, w0], args=(i_app, gamma, alpha, epsilon), t_eval=np.linspace(0, 2, 2000))
    ax.plot(sol.y[0], sol.y[1], label=f"IC: ({v0}, {w0})")
    # Mark the initial condition
    ax.plot(v0, w0, 'o', color='black')
plt.xlabel("v")
plt.ylabel("w")
plt.legend()
plt.show()
plt.close()
```

Follow the steps outline in [the CDIMA model](cdima.qmd) to explore how the FitzHugh–Nagumo system behaves for different initial conditions and parameters.

## Time Series and Excitability

In the **excitable** regime, trajectories typically stay near the resting equilibrium, but sufficiently large perturbations can trigger a large excursion
(a "spike") before returning to rest.

Below we plot the fast variable $v(t)$ for a fixed parameter set and initial condition.

```{python}
#| label: fig-time-series
#| fig-cap: "Time series $v(t)$ for the FitzHugh–Nagumo system (same parameters as the phase-plane plot). Depending on the initial condition, the solution may relax to rest or exhibit a spike/oscillation."
#| fig-width: 8
#| fig-height: 4
#| echo: false

vw = (0.3, 0.0)
t_span = [0, 2]
t_eval = np.linspace(t_span[0], t_span[1], 2000)

fig, ax = plt.subplots(figsize=(8, 4))
sol = solve_ivp(
    fitzhugh_nagumo,
    t_span,
    vw,
    args=(i_app, gamma, alpha, epsilon),
    t_eval=t_eval,
)

ax.plot(sol.t, sol.y[0], label=f"IC: ({vw[0]}, {vw[1]})")
plt.xlabel("Time (t)")
plt.ylabel("v(t)")
plt.legend()
plt.show()
plt.close()
```

Try changing the initial condition and parameters to see how the time series changes. What regimes of behavior do you observe? Can you connect these observations to the phase plane trajectories and the underlying theory of excitability?
